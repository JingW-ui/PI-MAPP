## é¢˜ç›®
ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•° k ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ä¸¤ä¸ª ä¸åŒçš„ç´¢å¼• i å’Œ j ï¼Œæ»¡è¶³ nums[i] == nums[j] ä¸” abs(i - j) <= k ã€‚å¦‚æœå­˜åœ¨ï¼Œè¿”å› true ï¼›å¦åˆ™ï¼Œè¿”å› false ã€‚

## æˆ‘çš„è§£ç­”
```
class Solution:
    def containsNearbyDuplicate(self, nums: List[int], k: int) -> bool:
        l = len(nums)
        for i in range(l):
            for j in range(l):
                if nums[i] == nums[j] and i != j and abs(i-j) <= k:
                    return True
        return False      
```
ä½ çš„å½“å‰è§£æ³•ä½¿ç”¨äº†**åŒé‡å¾ªç¯**ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º **O(nÂ²)**ï¼Œåœ¨æ•°ç»„è¾ƒå¤§æ—¶ï¼ˆä¾‹å¦‚ n = 10âµï¼‰ä¼šä¸¥é‡è¶…æ—¶ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ **å“ˆå¸Œè¡¨ï¼ˆå­—å…¸ï¼‰è®°å½•æ¯ä¸ªå…ƒç´ æœ€è¿‘å‡ºç°çš„ç´¢å¼•**ï¼Œå°†æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–åˆ° **O(n)**ï¼Œç©ºé—´å¤æ‚åº¦ O(n)ã€‚

---

### âœ… ä¼˜åŒ–æ€è·¯ï¼ˆæ»‘åŠ¨çª—å£ + å“ˆå¸Œè¡¨ï¼‰

- éå†æ•°ç»„ï¼Œç”¨ä¸€ä¸ªå­—å…¸ `last_index` è®°å½•æ¯ä¸ªæ•°å­—**æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®**ã€‚
- å¯¹äºå½“å‰å…ƒç´  `nums[i]`ï¼š
  - å¦‚æœå®ƒä¹‹å‰å‡ºç°è¿‡ï¼ˆå³åœ¨å­—å…¸ä¸­ï¼‰ï¼Œä¸” `i - last_index[nums[i]] <= k`ï¼Œè¯´æ˜æ‰¾åˆ°äº†æ»¡è¶³æ¡ä»¶çš„é‡å¤å¯¹ï¼Œè¿”å› `True`ã€‚
  - æ›´æ–° `last_index[nums[i]] = i`ï¼ˆå§‹ç»ˆä¿ç•™æœ€æ–°ä½ç½®ï¼Œå› ä¸ºåç»­åŒ¹é…åªéœ€è¦æœ€è¿‘çš„ç´¢å¼•æ‰èƒ½æ»¡è¶³æœ€å°è·ç¦»ï¼‰ã€‚

> ğŸ’¡ ä¸ºä»€ä¹ˆåªä¿ç•™æœ€è¿‘ä¸€æ¬¡çš„ä½ç½®ï¼Ÿ  
> å› ä¸ºæˆ‘ä»¬å¸Œæœ› `|i - j|` å°½å¯èƒ½å°ã€‚å¦‚æœæ—§ä½ç½®éƒ½ä¸æ»¡è¶³ `â‰¤ k`ï¼Œæ›´æ—©çš„ä½ç½®å°±æ›´ä¸å¯èƒ½æ»¡è¶³ã€‚

---

### âœ… ä¼˜åŒ–åçš„ä»£ç ï¼ˆæ¨èé¢è¯•å†™æ³•ï¼‰

```python
from typing import List

class Solution:
    def containsNearbyDuplicate(self, nums: List[int], k: int) -> bool:
        last_index = {}
        for i, num in enumerate(nums):
            if num in last_index and i - last_index[num] <= k:
                return True
            last_index[num] = i  # æ›´æ–°ä¸ºæœ€æ–°ç´¢å¼•
        return False
```

---

### ğŸ§ª ç¤ºä¾‹éªŒè¯

```python
sol = Solution()
print(sol.containsNearbyDuplicate([1,2,3,1], 3))      # True  (ç´¢å¼• 0 å’Œ 3ï¼Œå·®=3 â‰¤ 3)
print(sol.containsNearbyDuplicate([1,0,1,1], 1))      # True  (ç´¢å¼• 2 å’Œ 3ï¼Œå·®=1 â‰¤ 1)
print(sol.containsNearbyDuplicate([1,2,3,1,2,3], 2))  # False (ç›¸åŒæ•°å­—é—´è·éƒ½ >2)
```

---

### ğŸ” è¿›é˜¶ç†è§£ï¼šæ»‘åŠ¨çª—å£è§†è§’

ä½ ä¹Ÿå¯ä»¥ç†è§£ä¸ºç»´æŠ¤ä¸€ä¸ª**å¤§å°ä¸º k+1 çš„æ»‘åŠ¨çª—å£**ï¼Œçª—å£å†…ä¸èƒ½æœ‰é‡å¤å…ƒç´ ï¼š

```python
class Solution:
    def containsNearbyDuplicate(self, nums: List[int], k: int) -> bool:
        window = set()
        for i, num in enumerate(nums):
            if i > k:
                window.remove(nums[i - k - 1])  # ç§»å‡ºçª—å£å·¦è¾¹ç•Œçš„å…ƒç´ 
            if num in window:
                return True
            window.add(num)
        return False
```

- **ä¼˜ç‚¹**ï¼šç©ºé—´æœ€å¤šåªå­˜ `k+1` ä¸ªå…ƒç´ ï¼Œå½“ `k << n` æ—¶æ›´çœç©ºé—´ã€‚
- **ç¼ºç‚¹**ï¼šéœ€è¦é¢‘ç¹å¢åˆ é›†åˆå…ƒç´ ï¼Œå¸¸æ•°å› å­ç•¥é«˜ã€‚

> âš–ï¸ é€‰æ‹©å»ºè®®ï¼š
> - å¦‚æœ `k` å¾ˆå°ï¼ˆå¦‚ k=10ï¼‰ï¼Œç”¨ **æ»‘åŠ¨çª—å£ set**ï¼›
> - å¦‚æœ `k` å¯èƒ½å¾ˆå¤§ï¼ˆæ¥è¿‘ nï¼‰ï¼Œç”¨ **å“ˆå¸Œè¡¨è®°å½•æœ€åç´¢å¼•**ï¼ˆæ›´é€šç”¨ã€ç®€æ´ï¼‰ã€‚

---

### ğŸ“Œ é¢è¯•å›ç­”å»ºè®®

> â€œæˆ‘å¯ä»¥ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨è®°å½•æ¯ä¸ªæ•°å­—æœ€è¿‘å‡ºç°çš„ä½ç½®ã€‚éå†æ—¶ï¼Œå¦‚æœå‘ç°å½“å‰æ•°å­—ä¹‹å‰å‡ºç°è¿‡ï¼Œå¹¶ä¸”è·ç¦»ä¸è¶…è¿‡ kï¼Œå°±è¿”å› trueã€‚è¿™æ ·åªéœ€ä¸€æ¬¡éå†ï¼Œæ—¶é—´å¤æ‚åº¦ O(n)ï¼Œç©ºé—´ O(n)ã€‚â€

ç„¶åå†™å‡ºä¸Šé¢çš„å“ˆå¸Œè¡¨ç‰ˆæœ¬å³å¯ï¼Œæ¸…æ™°é«˜æ•ˆï¼

--- 

âœ… **æ€»ç»“**ï¼šä½ çš„åŸå§‹ O(nÂ²) è§£æ³•é€»è¾‘æ­£ç¡®ä½†æ•ˆç‡ä½ï¼›**ç”¨å“ˆå¸Œè¡¨è®°å½•æœ€åç´¢å¼•æ˜¯æ ‡å‡†æœ€ä¼˜è§£**ï¼Œä¹Ÿæ˜¯é¢è¯•å®˜æœŸå¾…çš„ç­”æ¡ˆã€‚

è¿™ä¸ªæŠ¥é”™æ˜¯ä¸ºå•¥ï¼Ÿ
  File "H:\pycharm_project\github_projects\PI-MAPP\Leetcode_study\string_test.py", line 8, in containsNearbyDuplicate
    if index in last_index and index - last_index[num] <= k:
KeyError: 2
è¿™ä¸ªæŠ¥é”™ **`KeyError: 2`** çš„æ ¹æœ¬åŸå› æ˜¯ä½ åœ¨å­—å…¸ `last_index` ä¸­ä½¿ç”¨äº†é”™è¯¯çš„é”®æ¥è®¿é—®ï¼

---

### ğŸ” é”™è¯¯ä»£ç åˆ†æ

ä½ å†™çš„æ˜¯ï¼š

```python
if index in last_index and index - last_index[num] <= k:
```

ä½†è¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š

1. **å˜é‡åæ··æ·†**ï¼šä½ ç”¨ `index` ä½œä¸ºå½“å‰ç´¢å¼•ï¼ˆåº”è¯¥æ˜¯ `i`ï¼‰ï¼Œä½†åˆ¤æ–­æ—¶å´ç”¨ `index in last_index` â€”â€” è€Œ `last_index` çš„ **é”®æ˜¯æ•°ç»„çš„å€¼ï¼ˆ`num`ï¼‰**ï¼Œä¸æ˜¯ç´¢å¼•ï¼
2. **å–å€¼é”™è¯¯**ï¼šå³ä½¿ `index in last_index` ä¸ºçœŸï¼ˆå…¶å®å‡ ä¹ä¸å¯èƒ½ï¼Œé™¤éæŸä¸ª `num == index`ï¼‰ï¼Œä½ åé¢åˆå»å– `last_index[num]`ï¼Œä½†å‰é¢åˆ¤æ–­çš„å´æ˜¯ `index` æ˜¯å¦åœ¨å­—å…¸é‡Œï¼Œé€»è¾‘å®Œå…¨é”™ä½ã€‚

æ›´ä¸¥é‡çš„æ˜¯ï¼š  
- `last_index` å­˜çš„æ˜¯ `{æ•°å€¼: æœ€è¿‘ç´¢å¼•}`ï¼Œæ¯”å¦‚ `{1: 3, 2: 5}`
- ä½†ä½ å†™ `index in last_index`ï¼Œç›¸å½“äºé—®ï¼šâ€œæ•°å­— 5 åœ¨ä¸åœ¨å­—å…¸çš„ key é‡Œï¼Ÿâ€ â€”â€” è¿™æ˜¯åœ¨æŸ¥ **ç´¢å¼•æ˜¯å¦ç­‰äºæŸä¸ªæ•°å€¼**ï¼Œå®Œå…¨åç¦»äº†æœ¬æ„ã€‚

è€Œ `KeyError: 2` è¯´æ˜ï¼š
- ä½ çš„ `num = 2`
- ä½†ä½ åœ¨ `last_index[num]`ï¼ˆå³ `last_index[2]`ï¼‰ä¹‹å‰ **æ²¡æœ‰ç¡®ä¿ `2` åœ¨å­—å…¸ä¸­**
- è™½ç„¶ä½ å†™äº† `index in last_index`ï¼Œä½†è¿™æ ¹æœ¬æ²¡æ£€æŸ¥ `num` æ˜¯å¦å­˜åœ¨ï¼

æ‰€ä»¥å½“ `num = 2` ä¸” `2` ä¸åœ¨ `last_index` ä¸­æ—¶ï¼Œ`last_index[2]` å°±ä¼šæŠ›å‡º `KeyError`ã€‚

---

### âœ… æ­£ç¡®å†™æ³•ï¼ˆä¿®æ­£å˜é‡å + é€»è¾‘ï¼‰

```python
from typing import List

class Solution:
    def containsNearbyDuplicate(self, nums: List[int], k: int) -> bool:
        last_index = {}
        for i, num in enumerate(nums):
            # æ£€æŸ¥ num æ˜¯å¦å‡ºç°è¿‡ï¼Œå¹¶ä¸”è·ç¦» <= k
            if num in last_index and i - last_index[num] <= k:
                return True
            last_index[num] = i  # æ›´æ–°æœ€æ–°ç´¢å¼•
        return False
```

### âŒ ä½ åŸä»£ç çš„å…¸å‹é”™è¯¯ç‰ˆæœ¬ï¼ˆå¯¼è‡´ KeyErrorï¼‰ï¼š

```python
# é”™è¯¯ç¤ºèŒƒ âŒ
for index in range(len(nums)):
    num = nums[index]
    if index in last_index and index - last_index[num] <= k:  # â† è¿™é‡Œï¼
        ...
```

- `index in last_index` â†’ æŸ¥çš„æ˜¯â€œç´¢å¼•æ˜¯å¦ä½œä¸º key å­˜åœ¨â€ï¼Œä½† key æ˜¯ `num`ï¼
- å³ä½¿è·³è¿‡è¿™ä¸ªæ¡ä»¶ï¼ˆå› ä¸º `index not in last_index`ï¼‰ï¼Œå¦‚æœè¿›å…¥ `else` æˆ–åç»­ç”¨äº† `last_index[num]`ï¼Œè€Œ `num` æ²¡å­˜è¿‡ï¼Œè¿˜æ˜¯ä¼š KeyErrorã€‚

---

### ğŸ’¡ å¦‚ä½•é¿å…è¿™ç±»é”™è¯¯ï¼Ÿ

1. **å‘½åæ¸…æ™°**ï¼šç”¨ `i` è¡¨ç¤ºç´¢å¼•ï¼Œ`num` è¡¨ç¤ºå€¼ï¼Œä¸è¦æ··ç”¨ã€‚
2. **æ˜ç¡®å­—å…¸ç»“æ„**ï¼šæ—¶åˆ»è®°ä½ `last_index` æ˜¯ `{value: latest_index}`ã€‚
3. **å…ˆæŸ¥ key å†å–å€¼**ï¼šæ°¸è¿œç”¨ `if key in dict` ä¿æŠ¤ `dict[key]`ã€‚

---

### âœ… æ€»ç»“

> **æŠ¥é”™åŸå› **ï¼šä½ ç”¨ `index in last_index` åˆ¤æ–­ï¼Œä½† `last_index` çš„ key æ˜¯æ•°ç»„å…ƒç´ å€¼ï¼ˆ`num`ï¼‰ï¼Œä¸æ˜¯ç´¢å¼•ã€‚å¯¼è‡´åç»­ `last_index[num]` è®¿é—®äº†ä¸€ä¸ªä¸å­˜åœ¨çš„ keyï¼ˆå¦‚ `2`ï¼‰ï¼Œå¼•å‘ `KeyError`ã€‚

**ä¿®å¤æ–¹æ³•**ï¼šæŠŠåˆ¤æ–­æ¡ä»¶æ”¹æˆ `if num in last_index and i - last_index[num] <= k`ï¼Œå¹¶ä½¿ç”¨æ¸…æ™°çš„å˜é‡åã€‚

è¿™æ ·å°±èƒ½æ­£ç¡®ã€é«˜æ•ˆåœ°è§£å†³é—®é¢˜ï¼

## ä¹Ÿå°±æ˜¯è¯´è¿™ä¹ˆè¿èµ·æ¥å†™æ—¶
pythonä¼šä¼˜å…ˆåˆ¤æ–­è¿™ä¸ª
 if num in last_index 
è‹¥è¯¥å¼å­ä¸ºå¦ å°±ç›´æ¥è·³è¿‡åé¢çš„äº†ï¼Ÿ
æ˜¯çš„ï¼âœ… **å®Œå…¨æ­£ç¡®**ã€‚

è¿™æ˜¯ Pythonï¼ˆä»¥åŠå¤§å¤šæ•°ç°ä»£ç¼–ç¨‹è¯­è¨€ï¼‰ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œå«åšï¼š

> **çŸ­è·¯æ±‚å€¼ï¼ˆShort-circuit Evaluationï¼‰**

---

### ğŸ” å…·ä½“åˆ°ä½ çš„ä¾‹å­ï¼š

```python
if num in last_index and i - last_index[num] <= k:
```

Python ä¼š **ä»å·¦åˆ°å³** ä¾æ¬¡åˆ¤æ–­æ¡ä»¶ï¼Œå¹¶ä¸”ï¼š

- å¦‚æœ `num in last_index` ä¸º **False**ï¼Œ  
  â†’ **ç›´æ¥è·³è¿‡** åé¢çš„ `i - last_index[num] <= k`ï¼Œ**ä¸å†æ‰§è¡Œå®ƒ**ã€‚
- åªæœ‰å½“ `num in last_index` ä¸º **True** æ—¶ï¼Œ  
  â†’ æ‰ä¼šç»§ç»­è®¡ç®— `i - last_index[num] <= k`ã€‚

---

### âœ… ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ

æ­£æ˜¯å› ä¸ºæœ‰**çŸ­è·¯æ±‚å€¼**ï¼Œæˆ‘ä»¬æ‰èƒ½å®‰å…¨åœ°å†™ï¼š

```python
if key in my_dict and my_dict[key] > 0:
    ...
```

è€Œä¸ç”¨æ‹…å¿ƒ `my_dict[key]` æŠ›å‡º `KeyError` â€”â€” å› ä¸ºå¦‚æœ `key not in my_dict`ï¼Œåé¢çš„ `my_dict[key]` æ ¹æœ¬ä¸ä¼šè¢«æ‰§è¡Œï¼

è¿™åœ¨å¤„ç†å­—å…¸ã€åˆ—è¡¨ç´¢å¼•ã€æ–‡ä»¶å¥æŸ„ã€ç©ºæŒ‡é’ˆç­‰åœºæ™¯ä¸­æå…¶å¸¸ç”¨ã€‚

---

### ğŸ§ª ä¸¾ä¸ªå®éªŒéªŒè¯

```python
def test():
    print("å‡½æ•°è¢«è°ƒç”¨äº†ï¼")
    return True

d = {}

# ä¸ä¼šæ‰“å° "å‡½æ•°è¢«è°ƒç”¨äº†ï¼"
if 'a' in d and test():
    pass

print("ç¨‹åºç»§ç»­è¿è¡Œ...")
```

è¾“å‡ºï¼š
```
ç¨‹åºç»§ç»­è¿è¡Œ...
```

â†’ è¯´æ˜ `test()` æ²¡æœ‰è¢«è°ƒç”¨ï¼Œå› ä¸º `'a' in d` ä¸º `False`ï¼ŒçŸ­è·¯äº†ã€‚

---

### âš ï¸ æ³¨æ„ï¼š`or` ä¹Ÿæœ‰çŸ­è·¯ï¼Œä½†é€»è¾‘ç›¸å

```python
if x or y:  # å¦‚æœ x ä¸º Trueï¼Œå°±ä¸çœ‹ y
if x and y: # å¦‚æœ x ä¸º Falseï¼Œå°±ä¸çœ‹ y
```

---

### âœ… æ€»ç»“

> æ˜¯çš„ï¼åœ¨ `if A and B:` ä¸­ï¼Œå¦‚æœ `A` ä¸º `False`ï¼ŒPython **ä¸ä¼šæ‰§è¡Œ B**ã€‚  
> è¿™å°±æ˜¯ **çŸ­è·¯æ±‚å€¼**ï¼Œä¹Ÿæ˜¯ä½ ä»£ç èƒ½å®‰å…¨è®¿é—® `last_index[num]` çš„å…³é”®ä¿éšœã€‚

æ‰€ä»¥ä½ çš„å†™æ³•ï¼š
```python
if num in last_index and i - last_index[num] <= k:
```
ä¸ä»…æ˜¯æ­£ç¡®çš„ï¼Œè€Œä¸”æ˜¯ **Python ä¸­çš„æ ‡å‡†å®‰å…¨æ¨¡å¼** ğŸ‘